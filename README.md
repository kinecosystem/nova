# nova

`nova` is a command-line tool for interacting with Horizon nodes.

## Building and Running
git clone and then `swift build`. To run, use something like this (see more documentation below):

```bash
swift run nova -config=./sample-config.json fund -key SAXSDD5YEU6GMTJ5IHA6K35VZHXFVPV6IHMWYAQPSEKJRNC5LGMUQX35  100000
```


## Options
option|description
-|-
`-config`|path to configuration file (default: config.json)
`-cfg-funder`|override of funding account secret key
`-cfg-whitelist`|override of secret key for whitelist holder account

## Commands
command|description
-|-
`keypairs`|generate keypairs
`create`|create accounts
`fund`|fund accounts
`whitelist`|manage the whitelist
`data`|manage data on an account
`pay`|send a payment between accounts
`dump`|print an archive file as JSON

### keypairs

The `keypairs` command generates a specified number keypairs and saves them to a file.

option|description
-|-
`-output`|the destination to which to write the keys (default: keypairs.json)

##### Examples

```bash
# generate 2 keypairs, saving them to keypairs.json

nova -config=./sample-config.json keypairs 2
```
```bash
# generate 1 keypair, saving it to test.json

nova -config=./sample-config.json keypairs -output=test.json 1
```

### create
The `create` command creates the specified accounts on the network.  Input is either from a file (generated by the `keypairs` command), or a single key on the command-line.  The funder is specified in the configuration file, or via the `-cfg-funder` option.

option|description
-|-
`-input`|the file from which to read keys (default: keypairs.json)
`-key`|a single key for which to create an account

##### Examples

```bash
# read from keypairs.json, creating accounts for all keys found

nova -config=./sample-config.json create
```
```bash
# read from keypairs.json, creating accounts for all keys found
# override the funding account

nova -cfg-funder=SAXSDD5YEU6GMTJ5IHA6K35VZHXFVPV6IHMWYAQPSEKJRNC5LGMUQX35 \
     -config=./sample-config.json create
```
```bash
# read from test.json, creating accounts for all keys found

nova -config=./sample-config.json create -input=test.json
```
```bash
# create a single account

nova -config=./sample-config.json create -key GC3Y3Y7DJ3J6PGNHI5KBUO7AXZXDTKUUYA6K3FVHDOFCEGYZJ27GHNAR
```

### fund
The `fund` command sends money to the specified accounts on the network. 

##### Examples

```bash
# fund a single account

nova -config=./sample-config.json fund -key GC3Y3Y7DJ3J6PGNHI5KBUO7AXZXDTKUUYA6K3FVHDOFCEGYZJ27GHNAR 100000
```

### whitelist
The `whitelist` command manages the whitelist.  The account which holds the whitelist is specified in the configuration file, or via the command-line, using the `-cfg-whitelist` option.  There are a number of subcommands, listed below.

command|description
-|-
`list`|list the reserve (if set), and the list of whitelisted keys
`add`|adds a key to the whitelist
`remove`|removes a key from the whitelist
`reserve`|sets the reserve for non-whitelisted transactions

##### list
```bash
nova -config=./sample-config.json whitelist list
```

##### add
```bash
nova -config=./sample-config.json whitelist add GC3Y3Y7DJ3J6PGNHI5KBUO7AXZXDTKUUYA6K3FVHDOFCEGYZJ27GHNAR
```

##### remove
```bash
nova -config=./sample-config.json whitelist remove GC3Y3Y7DJ3J6PGNHI5KBUO7AXZXDTKUUYA6K3FVHDOFCEGYZJ27GHNAR
```

##### reserve
```bash
# reserve up-to 13% of available slots for non-whitelisted transactions
nova -config=./sample-config.json whitelist reserve 13
```

### dump
The `dump` command prints the specified archive file as a JSON object.  The command supports the following file types: ledger, transactions, results, bucket.  The type is determined by the file name, and must be one of the following forms:

- `ledger-.*`
- `transactions-.*`
- `results-.*`
- `bucket-.*`

If the filename ends in `.gz`, the file must be gzip-compressed.

##### Examples

```bash
# dump a transactions history file
nova dump transactions-000cf87f.xdr.gz
```
